from node_manager.models import NodeManager
from node_manager.serializers import NodeManagerSerializer
from rest_framework_mongoengine import generics
from rest_framework.response import Response
from rest_framework.views import APIView
from rest_framework import status
from django.http import Http404

class NodeList(generics.ListCreateAPIView):
    queryset = NodeManager.objects.all()
    serializer_class = NodeManagerSerializer

class NodeManagerDetails(APIView):
    def get_object(self, id):
        obj_list = NodeManager.objects.filter(node=str(id))
        print('Dbggg2:', obj_list.count())
        if obj_list.count()>0:
            return obj_list.first()
        else:
            return None

    def get(self, request, id, format=None):
        node_manager = self.get_object(id)
        print('Dbggg:', node_manager)
        if not node_manager:
            raise Http404
        serializer = NodeManagerSerializer(node_manager)
        return Response(serializer.data, status=status.HTTP_201_CREATED)

