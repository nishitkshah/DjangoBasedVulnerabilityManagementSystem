import requests

def get_all_node_risk_scores():
    nodes = requests.get('http://127.0.0.1:8001/node_manager/').json()
    node_managers = set()
    risk_scores = []
    for node in nodes:
        node_managers.add(node['server_address'])
    for node_manager in node_managers:
        risk_score = requests.get('http://'+node_manager+'/node/risk_score/')
        risk_scores += risk_score.json()["nodes"]
    return risk_scores

def get_node_risk_score(pk):
    node = requests.get('http://127.0.0.1:8001/node_manager/'+pk+'/').json()
    risk_scores = requests.get('http://'+node['server_address']+'/node/risk_score/'+node['node']+'/')
    return risk_scores.json()

def get_resource_risk_score(pk, r_id):
    node = requests.get('http://127.0.0.1:8001/node_manager/'+pk+'/').json()
    risk_scores = requests.get('http://'+node['server_address']+'/node/risk_score/'+node['node']+'/'+r_id+'/')
    return risk_scores.json()

