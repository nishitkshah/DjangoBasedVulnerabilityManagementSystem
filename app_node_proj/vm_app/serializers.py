from rest_framework_mongoengine import serializers
from rest_framework import serializers as drf_serializers
from vm_app.models import Node, Resource, Finding

class NodeSerializer(serializers.DocumentSerializer):
    class Meta:
        model = Node
        fields = ('id', 'node_name', 'node_type', 'node_name_type', 'node_system_details', 'node_resources')

class ResourceSerializer(serializers.EmbeddedDocumentSerializer):
    class Meta:
        model = Resource
        fields = ('resource_id', 'resource', 'resource_criticality', 'resource_type', 'findings')

class FindingSerializer(serializers.EmbeddedDocumentSerializer):
    class Meta:
        model = Finding
        fields = ('finding_id', 'finding_details', 'finding_type', 'finding_severity', 'finding_score', 'finding_code', 'finding_code_type')

class NewFindingRequestSerializer(drf_serializers.Serializer):
    resource = drf_serializers.CharField()
    finding_details = drf_serializers.CharField()
    finding_type = drf_serializers.CharField(max_length=200)
    finding_code = drf_serializers.CharField()
    finding_code_type = drf_serializers.CharField(max_length=200)

